#Importamos las librerias necsarias para la creación de los gráficos
library(ggpattern)
library(ggpubr)
#Definimos los valores mencionados en el enunciado
n <- 100
mediaNula <- 10
sigma <- 1
limiteInferior <- 9.82
#Calculamos el error estandar
SE <- sigma / sqrt(n)
#Primero, se realiza el gráfico base
gXLimites <- mediaNula + c(-7, 7) * SE
g <- ggplot() + xlim(gXLimites) + ylim(c(0, 5))
g <- g + labs(title = "Distribución muestral de las medias", x = "Litros", y = "Densidad")
g <- g + theme_pubr()
#Agregamos la hipotesis nula
dist <- stat_function(fun = dnorm, geom = "area",
args = list(mean = mediaNula, sd = SE),
colour = "steelblue4", fill = "steelblue4", alpha = 0.2)
g1 <- g + dist
g1 <- g1 + geom_vline(xintercept = mediaNula, colour = "steelblue4")
#Convertimos el limite inferior a un z critico para su mejor entendimiento
zCriticoInferior <- limiteInferior
#Graficamos la cola inferior
g2 <- g1 + stat_function(fun = dnorm, geom = "area",
args = list(mean = mediaNula, sd = SE),
xlim = c(gXLimites[1], zCriticoInferior),
fill = "steelblue4", alpha = 0.4)
print(g2)
library(pwr)
library(tidyr)
#Definimos la fuincion para calcular el poder de la prueba z unilateral de cola inferior
f_pzl <- function(x) pwr.norm.test(x, n = n, sig.level = alfa, alternative = "less")[["power"]]
poderUnilat <- sapply(deltasNormalizados, f_pzl)
library(pwr)
library(tidyr)
#Definimos la fuincion para calcular el poder de la prueba z unilateral de cola inferior
f_pzl <- function(x) pwr.norm.test(x, n = n, sig.level = alfa, alternative = "less")[["power"]]
poderUnilat <- sapply(deltasNormalizados, f_pzl)
library(pwr)
library(tidyr)
#Definimos la fuincion para calcular el poder de la prueba z unilateral de cola inferior
f_pzl <- function(x) pwr.norm.test(x, n = n, sig.level = alfa, alternative = "less")[["power"]]
poderUnilat <- sapply(deltasNormalizados, f_pzl)
library(ggplot2)
#Mostramos los datos ya obtenidos para no tener que buscarlos
salidas <- c()
salidas <- c(salidas, paste("Muestras = ", n))
salidas <- c(salidas, paste("Media nula = ", mediaNula))
salidas <- c(salidas, paste("Desviación estandar = ", sigma))
salidas <- c(salidas, paste("Límite inferior = ", limiteInferior))
salidas <- c(salidas, paste("Error estandar = ", SE))
salidas <- c(salidas, paste("Alfa = ", alfa))
#Guardamos los nuevos datos
significancia <- 0.05
resultado <- pwr.t.test(d = delta, sig.level = significancia, power = 0.8, type = "one.sample")
